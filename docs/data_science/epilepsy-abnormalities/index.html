<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gabrielle M. Schroeder">
<meta name="dcterms.date" content="2023-07-07">

<title>Epilepsy research: Do brain abnormalities change over time?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/academicons-1.9.2/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/academicons-1.9.2/size.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text"><span id="gms">GMS</span></span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../data_science.html" rel="" target="">
 <span class="menu-text">DATA SCIENCE</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../data_vis.html" rel="" target="">
 <span class="menu-text">DATA VISUALISATION</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../gen_art.html" rel="" target="">
 <span class="menu-text">ART</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html" rel="" target="">
 <span class="menu-text">BLOG</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">ABOUT</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Epilepsy research: Do brain abnormalities change over time?</h1>
  <div class="quarto-categories">
    <div class="quarto-category">research project</div>
    <div class="quarto-category">Python</div>
    <div class="quarto-category">Adobe Illustrator</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Gabrielle M. Schroeder </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 7, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<style type="text/css">
.sourcetext {
text-align: right;
line-height: 1em;
font-size: 8pt;
color: #C2B286;
}
</style>
</div>
<div class="cell">
<style type="text/css">
.figandsource {
max-width: 500px;
margin: auto;
}
</style>
</div>
<p>The full details for this project are available in our open access paper, <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/epi.17663">Temporal stability of intracranial electroencephalographic abnormality maps for localizing epileptogenic tissue</a>. My Python code for generating the main figures is available on my <a href="https://github.com/gmschroe/temporal-stability-abnormalities">GitHub</a>.</p>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>When seizures are not controlled by medication, one of the few remaining treatment options is brain surgery to remove the part of the brain that causes seizures. However, identifying those regions can be difficult, and people with epilepsy often continue having seizures after surgery. The main focus of my postdoc research is developing computational measures that help pinpoint pathological brain regions so that they can successfully be removed.</p>
<p>This study investigated the stability of one of our measures of brain “abnormalities” that we use to identify pathological brain regions. Our measure is computed from intracranial EEG, which is recorded from electrodes that are temporarily implanted directly on or in the brain. These recordings are usually multiple days and capture a variety of brain activity, including periods of sleep, wake, and seizures. To use our abnormality measure clinically, we first need to know whether the measure is robust. How much is it influenced by the type of brain activity? How much data is needed to reliably compute our measure?</p>
<p>To determine the impact of removing brain abnormalities, we additionally computed a summary metric, D<sub>RS</sub>, that captures differences in abnormality levels between the resected (i.e., hypothesised to be pathological) and spared (thought to be healthy) brain regions. We expected D<sub>RS</sub> to differ depending on whether the subject was seizure free after surgery – indicating that the hypothesised pathological regions indeed caused seizures – or not seizure free.</p>
<p>We found that although there is some variability in abnormalities at the level of different brain regions, the relationship between resected and spared brain regions (as captured by the metric D<sub>RS</sub>) remained relatively consistent over time in each subject. Additionally, we could use D<sub>RS</sub> to distinguish subjects that were seizure free versus not seizure free after surgery.</p>
<p>We used a variety of plots to visualise the data at the level of individual subjects as well as the entire cohort - I’ve included a couple examples here. This figure shows that brain abnormalities and the summary D<sub>RS</sub> metric were similar in time periods close to seizures (“peri-ictal”) and far away from seizures (“interictal”). Subjects were divided by whether they had good (ILAE 1, blue) or poor (ILAE 2-5, red) treatment outcomes.</p>
<div class="figandsource">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="fig4.jpeg" class="lightbox" data-gallery="abnormalities"><img src="fig4.jpeg" class="img-fluid figure-img"></a></p>
</figure>
</div>
<div class="sourcetext">
<p><a href="https://onlinelibrary.wiley.com/doi/full/10.1111/epi.17663#">Wang et al.&nbsp;2023, Brain Communications</a></p>
</div>
</div>
<p>The figure below summarises results across subjects. We show the distribution of our summary measure in each subject and then used a machine learning classification metric to evaluate whether our measure distinguished subjects by their surgical outcomes.</p>
<div class="figandsource">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="fig3.jpeg" class="lightbox" data-gallery="abnormalities"><img src="fig3.jpeg" class="img-fluid figure-img"></a></p>
</figure>
</div>
<div class="sourcetext">
<p><a href="https://onlinelibrary.wiley.com/doi/full/10.1111/epi.17663#">Wang et al.&nbsp;2023, Brain Communications</a></p>
</div>
</div>
</section>
<section id="my-contributions" class="level2">
<h2 class="anchored" data-anchor-id="my-contributions">My contributions</h2>
<p>This project was a collaborative effort between five members of the lab as well as our clinical collaborators. Throughout the project, we met regularly to discuss preliminary results and brainstorm next steps. I was heavily involved in the analysis and writing. I worked with two other lab members to process and analyse the brain recording data, then drafted the manuscript’s methods, results, and supplementary material. I also generated most of the figures and final documented code, with feedback from the group.</p>
</section>
<section id="data-science-approaches" class="level2">
<h2 class="anchored" data-anchor-id="data-science-approaches">Data science approaches</h2>
<ul>
<li><p><strong>Data wrangling:</strong> Our lab has collaboratively created a large database of iEEG data along with patient, recording, and brain region metadata. A subset of this data was used and further organised for this project.</p></li>
<li><p><strong>Signal processing and time series frequency decomposition:</strong> We analysed brain activity in the frequency domain by computing power spectral densities and band power.</p></li>
<li><p><strong>Normative mapping:</strong> To determine if brain regions were abnormal, we compared brain activity in each patient to a normative map of our measure. This map describes normal brain dynamics in each brain region and was created using non-pathological brain regions from over 200 subjects from a separate iEEG study. Importantly, the normative map accounts for the well-known spatial variability in brain activity, allowing us to compare brain regions with different expected profiles of activity.</p></li>
<li><p><strong>Machine learning classification metrics:</strong> We defined our summary measure, D<sub>RS</sub>, as the area under the curve (AUC) for distinguishing resected and spared brain regions using abnormalities. We also used AUC to quantify whether D<sub>RS</sub> distinguishes patients who had good versus poor treatment outcomes.</p></li>
<li><p><strong>Non-parametric statistics:</strong> We used Wilcoxon rank sum tests to test whether our metric D<sub>RS</sub> significantly different between patients with good and patients with poor treatment outcomes.</p></li>
<li><p><strong>Dimensionality reduction and time series decomposition:</strong> As part of the exploratory phase of this project, we also used approaches such as non-negative matrix factorisation and empirical mode decomposition to investigate possible spatiotemporal patterns in patient abnormalities.</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left"><span class="faux-block">© Gabrielle Schroeder, 2023-2024</span> <span>Website made with <a href="https://quarto.org/"><strong>Quarto</strong></a></span></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/gmschroe">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/gabrielleschroeder">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://fosstodon.org/@gmschroe">
      <i class="bi bi-mastodon" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://scholar.google.com/citations?user=F82b47YAAAAJ&amp;hl=en"><i class="ai  ai-google-scholar"></i></a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"descPosition":"bottom","selector":".lightbox","closeEffect":"zoom","loop":true,"openEffect":"zoom"});</script>



</body></html>